<%- include ('../partials/head') %>
    <%- include ('../partials/menu') %>
        <%
        var correctguesses = locals.user.correctguesses;
        var streak = locals.user.streak;
        var longestStreak =  locals.user.longeststreak;
        var avgguess =  locals.user.avgguess;
        var totalgames = locals.user.totalgames;
        var losses = totalgames - correctguesses;
        var winRate = Math.floor( (correctguesses/totalgames)*100 );
        var lossRate = 100-winRate;
        var streakRanking = locals.rank[0];
        var avgRanking = locals.rank[1];
        var percent = 1;
        var pfp = locals.user.pfp;
        var username = locals.user.username;
        %>
        <style>
            table {
                border-collapse: collapse;
                width: 100%;
                border-bottom: 1px solid black"

            }
            h1{
                font-size:50px
            }
            th,
            td {
                text-align: left;
                padding: 8px;
            }

            .center {
                margin-left: auto;
                margin-right: auto;
            }
        </style>
        <table style="width: 90%" class="center">
            <tr>
                <td style="width: 15%">
                    <!-- Left side-->
                    <div style="text-align: center; background-color: lightgray; width: 110px; height: 110px; margin-left: auto; margin-right: auto;" class="rounded-circle" vertical-align: middle>
                        <span style="display: inline-block; height: 100%; vertical-align: middle; "></span>
                        <img src="img/pfp<%- pfp %>.png" width="100" height="100" class="rounded-circle">
                        <span style="display: inline-block; height: 100%; vertical-align: middle; "></span>
                    </div>
                    <br>
                    <h2 style="text-align: center;"><%- username %></h2>
                    <!-- Button trigger modal -->
                    <!--<div style="text-align: center;">
                        <button type="button" class="btn btn-primary" data-bs-toggle="modal"
                            data-bs-target="#exampleModal">
                            Edit Profile
                        </button> -->

                <td style="border-bottom:1px solid black">
                    <!-- Right side-->
                    <table>
                        <tr><br><br></tr>
                        <tr>
                            <td colspan="2" style="text-align: center;">
                                <h1>#<%- streakRanking %></h1>
                                <h4>In streaks</h4>
                            </td>
                            <td colspan="2" style="text-align: center;">
                                <h1> #<%- avgRanking %> </h1>
                                <h4 >In average guesses</h4>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <table>
                                    <tr>
                                        <td>
                                            <h2 style="text-align: center;">Total wins:</h2>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <h4 style="text-align: center;"><%- correctguesses %></h4>
                                        </td>
                                    </tr>
                                </table>

                            </td>
                            <td>
                                <table>
                                    <tr>
                                        <td>
                                            <h2 style="text-align: center;">Current streak:</h2>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <h4 style="text-align: center;"> <%- streak %></h4>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                            <td>
                                <table>
                                    <tr>
                                        <td>
                                            <h2 style="text-align: center;">Longest streak:</h2>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <!--TODO: Fix this-->
                                            <h4 style="text-align: center;"><%- longestStreak %></h4>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                            <td>
                                <table>
                                    <tr>
                                        <td>
                                            <h2 style="text-align: center;">Average guesses:</h2>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <h4 style="text-align: center;"><%- avgguess %></h4>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <!-- Win rate bar -->
                        <tr>
                            <td></td>
                            <td colspan="2">
                                <h3 style="text-align: center;">Win rate: <%- winRate %>%</h3>
                                <h5 style="text-align: center;">Out of <%- totalgames %> total games</h5>
                                <div class="progress">
                                    <div class="progress-bar bg-success" style="width: <%- winRate %>%"></div>
                                    <div class="progress-bar bg-danger" style="width: <%- lossRate %>%"></div>
                                </div>
                            </td>
                            <td></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>
                                <h6><%- correctguesses %> Wins</h6>
                            </td>
                            <td>
                                <h6 style="text-align: right;"><%- losses %> Losses</h6>
                            </td>
                            <td></td>
                        </tr>

                        <td>
                            <br><br>
                        </td>
                    </table>
                </td>
            </tr>
        </table>
        <%- include ('../partials/footer') %>